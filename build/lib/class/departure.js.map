{
  "version": 3,
  "sources": ["../../../src/lib/class/departure.ts"],
  "sourcesContent": ["import type * as Hafas from 'hafas-client';\nimport type { PublicTransport } from '../../main';\n//import { genericStateObjects } from '../const/definition';\nimport { BaseClass } from '../tools/library';\nimport { mapDeparturesToDepartureStates } from '../tools/mapper';\nimport { defaultDepartureOpt, type DepartureState, type Products } from '../types/types';\n\nexport class DepartureRequest extends BaseClass {\n    private delayOffset: number = this.adapter.config.delayOffset || 2;\n\n    constructor(adapter: PublicTransport) {\n        super(adapter);\n        this.log.setLogPrefix('depReq');\n    }\n\n    /**\n     * Validiert, ob der initialisierte Client und das Profil mit dem angegebenen client_profile \u00FCbereinstimmen.\n     *\n     * @param client_profile Das erwartete Client-Profil (z.B. \"hafas:vbb\", \"vendo:db\")\n     * @throws Error wenn Client-Typ oder Profil nicht \u00FCbereinstimmen\n     */\n    private validateClientProfile(client_profile?: string): void {\n        if (!client_profile) {\n            return; // Keine Validierung wenn nicht angegeben\n        }\n\n        // Parse client_profile (z.B. \"hafas:vbb\" -> serviceType: \"hafas\", profile: \"vbb\")\n        const parts = client_profile.split(':');\n        const expectedServiceType = parts[0]; // 'hafas' oder 'vendo'\n        const expectedProfile = parts[1] || ''; // z.B. 'vbb', 'oebb', 'db'\n\n        // Pr\u00FCfe, ob der richtige Service-Typ initialisiert ist\n        const currentServiceType = this.adapter.config.serviceType || 'hafas';\n        if (currentServiceType !== expectedServiceType) {\n            throw new Error(\n                this.library.translate('msg_wrongClientType', expectedServiceType, currentServiceType, client_profile),\n            );\n        }\n\n        // Pr\u00FCfe das Profil (nur relevant bei HAFAS)\n        if (expectedServiceType === 'hafas' && expectedProfile) {\n            const currentProfile = this.adapter.config.profile || '';\n            if (currentProfile !== expectedProfile) {\n                throw new Error(\n                    this.library.translate('msg_wrongProfile', expectedProfile, currentProfile, client_profile),\n                );\n            }\n        }\n    }\n\n    /**\n     *  Ruft Abfahrten f\u00FCr eine gegebene stationId ab und schreibt sie in die States.\n     *\n     * @param stationId     Die ID der Station, f\u00FCr die Abfahrten abgefragt werden sollen.\n     * @param service      Der Service f\u00FCr die Abfrage.\n     * @param options      Zus\u00E4tzliche Optionen f\u00FCr die Abfrage.\n     * @param countEntries Die maximale Anzahl der Eintr\u00E4ge, die geschrieben werden sollen.\n     * @param products     Die aktivierten Produkte (true = erlaubt)\n     * @param client_profile Das Client-Profil f\u00FCr die Abfrage (z.B. \"hafas:vbb\", \"vendo:db\")\n     * @returns             true bei Erfolg, sonst false.\n     */\n    public async getDepartures(\n        stationId: string,\n        service: any,\n        options: Hafas.DeparturesArrivalsOptions = {},\n        countEntries: number = 10,\n        products?: Partial<Products>,\n        client_profile?: string,\n    ): Promise<boolean> {\n        try {\n            if (!stationId) {\n                throw new Error(this.library.translate('msg_departureNoStationId'));\n            }\n\n            // Validiere Client und Profil\n            this.validateClientProfile(client_profile);\n            const mergedOptions = { ...defaultDepartureOpt, ...options };\n            // Antwort vom Tranport-Client als vollst\u00E4ndiger Typ\n            const response = await service.getDepartures(stationId, mergedOptions);\n            // Vollst\u00E4ndiges JSON f\u00FCr Debugging\n            //this.adapter.log.debug(JSON.stringify(response.departures, null, 1));\n            // Schreibe die Abfahrten in die States\n            await this.writeDepartureStates(stationId, response.departures, products, countEntries);\n            return true;\n        } catch (error) {\n            this.log.error(this.library.translate('msg_departureQueryError', stationId, (error as Error).message));\n            return false;\n        }\n    }\n\n    /**\n     * Filtert Abfahrten nach den gew\u00E4hlten Produkten.\n     * Es werden nur Abfahrten zur\u00FCckgegeben, deren Produkt in den aktivierten Produkten enthalten ist.\n     *\n     * @param departures    Die zu filternden Abfahrten\n     * @param products      Die aktivierten Produkte (true = erlaubt)\n     * @returns             Gefilterte Abfahrten\n     */\n    filterByProducts(departures: readonly Hafas.Alternative[], products: Partial<Products>): Hafas.Alternative[] {\n        // Erstelle eine Liste der aktivierten Produktnamen\n        const enabledProducts = Object.entries(products)\n            .filter(([_, enabled]) => enabled === true)\n            .map(([productName, _]) => productName);\n\n        // Wenn keine Produkte aktiviert sind, gib alle zur\u00FCck\n        if (enabledProducts.length === 0) {\n            return [...departures];\n        }\n\n        // Filtere Abfahrten: behalte nur die, deren line.product in enabledProducts ist\n        return departures.filter(departure => {\n            const lineProduct = departure.line?.product;\n            if (!lineProduct) {\n                this.log.info2(\n                    this.library.translate(\n                        'msg_departureFilterNoProduct',\n                        departure.line?.name || 'unbekannt / unknown',\n                        departure.direction ?? 'unbekannt / unknown',\n                    ),\n                );\n                return false;\n            }\n            const isEnabled = enabledProducts.includes(lineProduct);\n            if (!isEnabled) {\n                this.log.info2(\n                    this.library.translate(\n                        'msg_departureFilterProductDisabled',\n                        departure.line?.name || 'unbekannt / unknown',\n                        departure.direction ?? 'unbekannt / unknown',\n                        lineProduct,\n                    ),\n                );\n            }\n            return isEnabled;\n        });\n    }\n\n    /**\n     * Schreibt die Abfahrten in die States der angegebenen Station.\n     *\n     * @param stationId     Die ID der Station, f\u00FCr die die Abfahrten geschrieben werden sollen.\n     * @param departures    Die Abfahrten, die geschrieben werden sollen.\n     * @param products      Die aktivierten Produkte (true = erlaubt)\n     * @param countEntries  Die maximale Anzahl der Eintr\u00E4ge, die geschrieben werden sollen.\n     */\n    async writeDepartureStates(\n        stationId: string,\n        departures: Hafas.Alternative[],\n        products?: Partial<Products>,\n        countEntries: number = 10,\n    ): Promise<void> {\n        try {\n            if (this.adapter.config.stationConfig) {\n                for (const departure of this.adapter.config.stationConfig) {\n                    // Erstelle Station\n                    await this.library.writedp(`${this.adapter.namespace}.Stations.${departure.id}`, undefined, {\n                        _id: 'nicht_definieren',\n                        type: 'folder',\n                        common: {\n                            name: departure.customName || departure.name || 'Station',\n                            statusStates: { onlineId: `${this.adapter.namespace}.Stations.${departure.id}.enabled` },\n                        },\n                        native: {},\n                    });\n                    await this.library.writedp(\n                        `${this.adapter.namespace}.Stations.${departure.id}.json`,\n                        departure.enabled ? JSON.stringify(departures) : '',\n                        {\n                            _id: 'nicht_definieren',\n                            type: 'state',\n                            common: {\n                                name: this.library.translate('raw_departure_data'),\n                                type: 'string',\n                                role: 'json',\n                                read: true,\n                                write: false,\n                            },\n                            native: {},\n                        },\n                    );\n                    await this.library.writedp(\n                        `${this.adapter.namespace}.Stations.${departure.id}.enabled`,\n                        departure.enabled,\n                        {\n                            _id: 'nicht_definieren',\n                            type: 'state',\n                            common: {\n                                name: this.library.translate('station_enabled'),\n                                type: 'boolean',\n                                role: 'indicator',\n                                read: true,\n                                write: false,\n                            },\n                            native: {},\n                        },\n                    );\n\n                    // Vor dem Schreiben alte States l\u00F6schen\n                    await this.library.garbageColleting(`${this.adapter.namespace}.Stations.${departure.id}.`, 2000);\n                    if (departure.enabled === true && departure.id === stationId) {\n                        // Filtere nach Produkten, falls angegeben\n                        const filteredDepartures = products ? this.filterByProducts(departures, products) : departures;\n                        // Konvertiere zu reduzierten States\n                        const departureStates: DepartureState[] = mapDeparturesToDepartureStates(filteredDepartures);\n                        // JSON in die States schreiben\n                        await this.writeBaseStates(departureStates, stationId, countEntries);\n                    }\n                }\n            }\n        } catch (err) {\n            this.log.error(this.library.translate('msg_departureWriteError', (err as Error).message));\n        }\n    }\n\n    /**\n     * schreibt die Abfahrts-States in die ioBroker States.\n     *\n     * @param response  Die Abfahrts-States, die geschrieben werden sollen.\n     * @param stationId  Die ID der Station, f\u00FCr die die States geschrieben werden sollen.\n     * @param countEntries  Die maximale Anzahl der Eintr\u00E4ge, die geschrieben werden sollen.\n     */\n    async writeBaseStates(response: DepartureState[], stationId: string, countEntries: number): Promise<void> {\n        for (const [index, obj] of response.entries()) {\n            try {\n                this.log.info2(`=== Starte Objekt ${index + 1} von ${response.length} ===`);\n                const departureIndex = `Departures_${`00${index}`.slice(-2)}`;\n                const [delayed, onTime] = await this.library.getDelayStatus(obj.delay, this.delayOffset);\n                // Erstelle Channel Departures_XX und darunter die States\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}`,\n                    undefined,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'channel',\n                        common: {\n                            name: departureIndex,\n                        },\n                        native: {},\n                    },\n                );\n                // Departure\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.Departure`,\n                    obj.when,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_time'),\n                            type: 'string',\n                            role: 'date',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Planned Departure Time\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.DeparturePlanned`,\n                    obj.plannedWhen,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_plannedTime'),\n                            type: 'string',\n                            role: 'date',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Delay in Seconds\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.Delay`,\n                    obj.delay || 0,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_delayInSeconds'),\n                            type: 'number',\n                            role: 'time',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Departure Delayed\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.DepartureDelayed`,\n                    delayed,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_isDelayed'),\n                            type: 'boolean',\n                            role: 'indicator',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Departure On Time\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.DepartureOnTime`,\n                    onTime,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_isOnTime'),\n                            type: 'boolean',\n                            role: 'indicator',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Platform\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.Platform`,\n                    obj.platform,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_platform'),\n                            type: 'string',\n                            role: 'text',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Planned Platform\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.PlatformPlanned`,\n                    obj.plannedPlatform,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_plannedPlatform'),\n                            type: 'string',\n                            role: 'text',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Direction\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.Direction`,\n                    obj.direction,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_direction'),\n                            type: 'string',\n                            role: 'text',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Line Name\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.Name`,\n                    obj.line?.name,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_lineName'),\n                            type: 'string',\n                            role: 'text',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Line Product\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.Product`,\n                    obj.line?.product,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_lineProduct'),\n                            type: 'string',\n                            role: 'text',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Line Operator\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.Operator`,\n                    obj.line?.operator,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_lineOperator'),\n                            type: 'string',\n                            role: 'text',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Line Mode\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.Mode`,\n                    obj.line?.mode,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_lineMode'),\n                            type: 'string',\n                            role: 'text',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Remarks Channel\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.Remarks`,\n                    undefined,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'channel',\n                        common: {\n                            name: this.library.translate('departure_remark'),\n                        },\n                        native: {},\n                    },\n                );\n                // Remark Hint\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.Remarks.Hint`,\n                    obj.remarks?.hint,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_remarkHint'),\n                            type: 'string',\n                            role: 'text',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Remark Status\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.Remarks.Status`,\n                    obj.remarks?.status,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_remarkStatus'),\n                            type: 'string',\n                            role: 'text',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Remark warning\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.Remarks.Warning`,\n                    obj.remarks?.warning,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_remarkWarning'),\n                            type: 'string',\n                            role: 'text',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Stop Channel\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.Stop`,\n                    undefined,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'channel',\n                        common: {\n                            name: this.library.translate('departure_stop'),\n                        },\n                        native: {},\n                    },\n                );\n                // Stop Name\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.Stop.Name`,\n                    obj.stopinfo?.name,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_stopName'),\n                            type: 'string',\n                            role: 'text',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Stop Id\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.Stop.Id`,\n                    obj.stopinfo?.id,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_stopId'),\n                            type: 'string',\n                            role: 'text',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                // Stop Type\n                await this.library.writedp(\n                    `${this.adapter.namespace}.Stations.${stationId}.${departureIndex}.Stop.Type`,\n                    obj.stopinfo?.type,\n                    {\n                        _id: 'nicht_definieren',\n                        type: 'state',\n                        common: {\n                            name: this.library.translate('departure_stopType'),\n                            type: 'string',\n                            role: 'text',\n                            read: true,\n                            write: false,\n                        },\n                        native: {},\n                    },\n                    true,\n                );\n                this.log.info2(`\u2713 Objekt ${index + 1} erfolgreich verarbeitet`);\n                if (index === countEntries) {\n                    this.log.debug(\n                        `=== Maximale Anzahl an Eintr\u00E4gen erreicht (${countEntries}), weitere Abfahrten werden nicht verarbeitet ===`,\n                    );\n                    break;\n                }\n            } catch (err) {\n                this.log.error(`\u2717 Fehler bei Objekt ${index + 1}:`, (err as Error).message);\n                // Ohne throw: weiter zur n\u00E4chsten Abfahrt \u2705 (empfohlen)\n                // Mit throw: alle weiteren Abfahrten werden NICHT verarbeitet \u274C\n            }\n        }\n    }\n}\n"],
  "mappings": "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",
  "names": []
}
