{
  "version": 3,
  "sources": ["../../../src/lib/tools/mapper.ts"],
  "sourcesContent": ["import type * as Hafas from 'hafas-client';\nimport type { DepartureState, JourneyState, StationState } from '../types/types';\n/**\n * Gruppiert Remarks nach Typ und fasst deren Texte zusammen\n *\n * @param remarks Array von Remark Objekten\n */\nfunction groupRemarksByType(remarks: readonly (Hafas.Hint | Hafas.Status | Hafas.Warning)[]): {\n    hint: string | undefined;\n    warning: string | undefined;\n    status: string | undefined;\n} {\n    const hints: string[] = [];\n    const warnings: string[] = [];\n    const statuses: string[] = [];\n\n    for (const remark of remarks) {\n        switch (remark.type) {\n            case 'hint':\n                hints.push(remark.text ?? '');\n                break;\n            case 'warning':\n                warnings.push(remark.text ?? '');\n                break;\n            case 'status':\n                statuses.push(remark.text ?? '');\n                break;\n        }\n    }\n\n    return {\n        hint: hints.length > 0 ? hints.join('\\n') : undefined,\n        warning: warnings.length > 0 ? warnings.join('\\n') : undefined,\n        status: statuses.length > 0 ? statuses.join('\\n') : undefined,\n    };\n}\n\n/**\n * Konvertiert HAFAS Departure zu reduzierten DepartureState\n *\n * @param departure HAFAS Departure Objekt\n */\nexport function mapDepartureToDepartureState(departure: Hafas.Alternative): DepartureState {\n    return {\n        when: departure.when ?? undefined,\n        plannedWhen: departure.plannedWhen ?? undefined,\n        delay: departure.delay ?? undefined,\n        direction: departure.direction ?? undefined,\n        platform: departure.platform ?? undefined,\n        plannedPlatform: departure.plannedPlatform ?? undefined,\n        line: {\n            name: departure.line?.name ?? undefined,\n            fahrtNr: departure.line?.fahrtNr ?? undefined,\n            productName: departure.line?.productName ?? undefined,\n            mode: departure.line?.mode ?? undefined,\n            product: departure.line?.product ?? undefined,\n            operator: departure.line?.operator?.name ?? undefined,\n        },\n        remarks: groupRemarksByType(departure.remarks ?? []),\n        stopinfo: {\n            name: departure.stop?.name ?? undefined,\n            id: departure.stop?.id ?? undefined,\n            type: departure.stop?.type ?? undefined,\n            location: departure.stop?.location\n                ? {\n                      latitude: departure.stop.location.latitude ?? undefined,\n                      longitude: departure.stop.location.longitude ?? undefined,\n                  }\n                : undefined,\n        },\n    };\n}\n\n/**\n * Konvertiert Array von Departures zu Array von DepartureStates\n *\n * @param departures Array von HAFAS Departure Objekten\n */\nexport function mapDeparturesToDepartureStates(departures: readonly Hafas.Alternative[]): DepartureState[] {\n    return departures.map(mapDepartureToDepartureState);\n}\n\n/**\n * Konvertiert DeparturesResponse zu Array von DepartureStates\n *\n * @param response HAFAS DeparturesResponse Objekt\n */\nexport function mapDeparturesResponseToStates(response: Hafas.Departures): DepartureState[] {\n    return mapDeparturesToDepartureStates(response.departures);\n}\n\nexport function mapStationToStationState(station: Hafas.Station): StationState {\n    return {\n        name: station.name,\n        id: station.id,\n        type: station.type,\n        location: station.location\n            ? {\n                  latitude: station.location.latitude,\n                  longitude: station.location.longitude,\n              }\n            : undefined,\n        stops:\n            station.type === 'station'\n                ? (station.stops\n                      ?.filter((stop): stop is Hafas.Stop => stop.type === 'stop')\n                      .map(stop => ({\n                          name: stop.name ?? undefined,\n                          id: stop.id ?? undefined,\n                          type: stop.type ?? undefined,\n                          location: stop.location\n                              ? {\n                                    latitude: stop.location.latitude ?? undefined,\n                                    longitude: stop.location.longitude ?? undefined,\n                                }\n                              : undefined,\n                          products: stop.products\n                              ? {\n                                    suburban: stop.products.suburban ?? undefined,\n                                    subway: stop.products.subway ?? undefined,\n                                    tram: stop.products.tram ?? undefined,\n                                    bus: stop.products.bus ?? undefined,\n                                    ferry: stop.products.ferry ?? undefined,\n                                    express: stop.products.express ?? undefined,\n                                    regional: stop.products.regional ?? undefined,\n                                }\n                              : undefined,\n                      })) ?? undefined)\n                : undefined,\n    };\n}\n\nexport function mapJourneyToJourneyState(journey: Hafas.Journey): JourneyState {\n    return {\n        legs:\n            journey.legs?.map(leg => ({\n                tripId: leg.tripId ?? undefined,\n                stationFrom: {\n                    id: leg.origin?.id ?? undefined,\n                    name: leg.origin?.name ?? undefined,\n                    type: leg.origin?.type ?? undefined,\n                    location:\n                        leg.origin?.type === 'station' || leg.origin?.type === 'stop'\n                            ? leg.origin.location\n                                ? {\n                                      latitude: leg.origin.location.latitude ?? undefined,\n                                      longitude: leg.origin.location.longitude ?? undefined,\n                                  }\n                                : undefined\n                            : undefined,\n                    //products: leg.origin && 'products' in leg.origin ? leg.origin.products : undefined,\n                },\n                stationTo: {\n                    id: leg.destination?.id ?? undefined,\n                    name: leg.destination?.name ?? undefined,\n                    type: leg.destination?.type ?? undefined,\n                    location:\n                        leg.destination?.type === 'station' || leg.destination?.type === 'stop'\n                            ? leg.destination.location\n                                ? {\n                                      latitude: leg.destination.location.latitude ?? undefined,\n                                      longitude: leg.destination.location.longitude ?? undefined,\n                                  }\n                                : undefined\n                            : undefined,\n                    //products: leg.destination && 'products' in leg.destination ? leg.destination.products : undefined,\n                },\n                departure: leg.departure ?? undefined,\n                plannedDeparture: leg.plannedDeparture ?? undefined,\n                departureDelay: leg.departureDelay ?? undefined,\n                arrival: leg.arrival ?? undefined,\n                plannedArrival: leg.plannedArrival ?? undefined,\n                arrivalDelay: leg.arrivalDelay ?? undefined,\n                //reachable: leg.reachable ?? undefined,\n                line: leg.line\n                    ? {\n                          //type: leg.line.type ?? undefined,\n                          id: leg.line.id ?? undefined,\n                          name: leg.line.name ?? undefined,\n                          fahrtNr: leg.line.fahrtNr ?? undefined,\n                          productName: leg.line.productName ?? undefined,\n                          mode: leg.line.mode ?? undefined,\n                          product: leg.line.product ?? undefined,\n                          operator: leg.line.operator?.name ?? undefined,\n                      }\n                    : undefined,\n                direction: leg.direction ?? undefined,\n                arrivalPlatform: leg.arrivalPlatform ?? undefined,\n                plannedArrivalPlatform: leg.plannedArrivalPlatform ?? undefined,\n                departurePlatform: leg.departurePlatform ?? undefined,\n                plannedDeparturePlatform: leg.plannedDeparturePlatform ?? undefined,\n                arrivalPrognosisType: leg.arrivalPrognosisType ?? undefined,\n                departurePrognosisType: leg.departurePrognosisType ?? undefined,\n                remarks: leg.remarks ? groupRemarksByType(leg.remarks) : undefined,\n                /*cycle: leg.cycle\n                    ? {\n                          min: leg.cycle.min ?? undefined,\n                          max: leg.cycle.max ?? undefined,\n                          nr: leg.cycle.nr ?? undefined,\n                      }\n                    : undefined,*/\n                alternatives: leg.alternatives?.map(alt => ({\n                    tripId: alt.tripId ?? undefined,\n                    line: alt.line\n                        ? {\n                              type: alt.line.type ?? undefined,\n                              id: alt.line.id ?? undefined,\n                              name: alt.line.name ?? undefined,\n                              fahrtNr: alt.line.fahrtNr ?? undefined,\n                              productName: alt.line.productName ?? undefined,\n                              mode: alt.line.mode ?? undefined,\n                              product: alt.line.product ?? undefined,\n                              operator: alt.line.operator?.name ?? undefined,\n                          }\n                        : undefined,\n                    direction: alt.direction ?? undefined,\n                    when: alt.when ?? undefined,\n                    plannedWhen: alt.plannedWhen ?? undefined,\n                    delay: alt.delay ?? undefined,\n                })),\n            })) ?? undefined,\n        //remarks: journey.remarks ? groupRemarksByType(journey.remarks) : undefined,\n        //refreshToken: journey.refreshToken ?? undefined,\n    };\n}\n\n/**\n * Konvertiert Array von Journeys zu Array von JourneyStates\n * Jede Journey bleibt als separate Einheit mit ihren Legs erhalten\n *\n * @param journeys Array von HAFAS Journey Objekten\n */\nexport function mapJourneysToJourneyStates(journeys: readonly Hafas.Journey[]): JourneyState[] {\n    return journeys.map(mapJourneyToJourneyState);\n}\n"],
  "mappings": "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",
  "names": ["_a", "_b", "_c", "_d", "_e", "_f", "_g", "_h", "_i", "_j", "_k", "_l", "_m", "_n"]
}
