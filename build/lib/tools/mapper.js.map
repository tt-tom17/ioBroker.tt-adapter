{
  "version": 3,
  "sources": ["../../../src/lib/tools/mapper.ts"],
  "sourcesContent": ["import type * as Hafas from 'hafas-client';\nimport type { DepartureState, JourneyState, StationState } from '../types/types';\n/**\n * Gruppiert Remarks nach Typ und fasst deren Texte zusammen\n *\n * @param remarks Array von Remark Objekten\n */\nfunction groupRemarksByType(remarks: readonly (Hafas.Hint | Hafas.Status | Hafas.Warning)[]): {\n    hint: string | undefined;\n    warning: string | undefined;\n    status: string | undefined;\n} {\n    const hints: string[] = [];\n    const warnings: string[] = [];\n    const statuses: string[] = [];\n\n    for (const remark of remarks) {\n        switch (remark.type) {\n            case 'hint':\n                hints.push(remark.text ?? '');\n                break;\n            case 'warning':\n                warnings.push(remark.text ?? '');\n                break;\n            case 'status':\n                statuses.push(remark.text ?? '');\n                break;\n        }\n    }\n\n    return {\n        hint: hints.length > 0 ? hints.join('\\n') : undefined,\n        warning: warnings.length > 0 ? warnings.join('\\n') : undefined,\n        status: statuses.length > 0 ? statuses.join('\\n') : undefined,\n    };\n}\n\n/**\n * Konvertiert HAFAS Departure zu reduzierten DepartureState\n *\n * @param departure HAFAS Departure Objekt\n */\nexport function mapDepartureToDepartureState(departure: Hafas.Alternative): DepartureState {\n    return {\n        when: departure.when ?? undefined,\n        plannedWhen: departure.plannedWhen ?? undefined,\n        delay: departure.delay ?? undefined,\n        direction: departure.direction ?? undefined,\n        platform: departure.platform ?? undefined,\n        plannedPlatform: departure.plannedPlatform ?? undefined,\n        line: {\n            name: departure.line?.name ?? undefined,\n            fahrtNr: departure.line?.fahrtNr ?? undefined,\n            productName: departure.line?.productName ?? undefined,\n            mode: departure.line?.mode ?? undefined,\n            operator: departure.line?.operator?.name ?? undefined,\n        },\n        remarks: groupRemarksByType(departure.remarks ?? []),\n        stopinfo: {\n            name: departure.stop?.name ?? undefined,\n            id: departure.stop?.id ?? undefined,\n            type: departure.stop?.type ?? undefined,\n            location: departure.stop?.location\n                ? {\n                      latitude: departure.stop.location.latitude ?? undefined,\n                      longitude: departure.stop.location.longitude ?? undefined,\n                  }\n                : undefined,\n        },\n    };\n}\n\n/**\n * Konvertiert Array von Departures zu Array von DepartureStates\n *\n * @param departures Array von HAFAS Departure Objekten\n */\nexport function mapDeparturesToDepartureStates(departures: readonly Hafas.Alternative[]): DepartureState[] {\n    return departures.map(mapDepartureToDepartureState);\n}\n\n/**\n * Konvertiert DeparturesResponse zu Array von DepartureStates\n *\n * @param response HAFAS DeparturesResponse Objekt\n */\nexport function mapDeparturesResponseToStates(response: Hafas.Departures): DepartureState[] {\n    return mapDeparturesToDepartureStates(response.departures);\n}\n\nexport function mapStationToStationState(station: Hafas.Station | Hafas.Stop): StationState {\n    return {\n        name: station.name,\n        id: station.id,\n        type: station.type,\n        location: station.location\n            ? {\n                  latitude: station.location.latitude,\n                  longitude: station.location.longitude,\n              }\n            : undefined,\n    };\n}\n\nexport function mapJourneyToJourneyState(journey: Hafas.Journeys): JourneyState {\n    return {\n        legs:\n            journey.journeys?.flatMap(\n                j =>\n                    j.legs?.map(leg => ({\n                        stationFrom: {\n                            id: leg.origin?.id ?? undefined,\n                            name: leg.origin?.name ?? undefined,\n                            type: leg.origin?.type ?? undefined,\n                            location:\n                                leg.origin?.type === 'station' || leg.origin?.type === 'stop'\n                                    ? leg.origin.location\n                                        ? {\n                                              latitude: leg.origin.location.latitude ?? undefined,\n                                              longitude: leg.origin.location.longitude ?? undefined,\n                                          }\n                                        : undefined\n                                    : undefined,\n                        },\n                        stationTo: {\n                            id: leg.destination?.id ?? undefined,\n                            name: leg.destination?.name ?? undefined,\n                            type: leg.destination?.type ?? undefined,\n                            location:\n                                leg.destination?.type === 'station' || leg.destination?.type === 'stop'\n                                    ? leg.destination.location\n                                        ? {\n                                              latitude: leg.destination.location.latitude ?? undefined,\n                                              longitude: leg.destination.location.longitude ?? undefined,\n                                          }\n                                        : undefined\n                                    : undefined,\n                        },\n                        departure: leg.departure ?? undefined,\n                        plannedDeparture: leg.plannedDeparture ?? undefined,\n                        departureDelay: leg.departureDelay ?? undefined,\n                        arrival: leg.arrival ?? undefined,\n                        plannedArrival: leg.plannedArrival ?? undefined,\n                        arrivalDelay: leg.arrivalDelay ?? undefined,\n                        line: leg.line\n                            ? {\n                                  name: leg.line.name ?? undefined,\n                                  fahrtNr: leg.line.fahrtNr ?? undefined,\n                                  productName: leg.line.productName ?? undefined,\n                                  mode: leg.line.mode ?? undefined,\n                                  operator: leg.line.operator?.name ?? undefined,\n                              }\n                            : undefined,\n                        direction: leg.direction ?? undefined,\n                        arrivalPlatform: leg.arrivalPlatform ?? undefined,\n                        plannedArrivalPlatform: leg.plannedArrivalPlatform ?? undefined,\n                        departurePlatform: leg.departurePlatform ?? undefined,\n                        plannedDeparturePlatform: leg.plannedDeparturePlatform ?? undefined,\n                        remarks: leg.remarks ? groupRemarksByType(leg.remarks) : undefined,\n                    })) ?? [],\n            ) ?? undefined,\n    };\n}\n"],
  "mappings": "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",
  "names": ["_a", "_b"]
}
